<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>宏控件属性</title>
    <style type="text/css">
      body {
      font-size:12px;
      margin: 0px;
      background-color:#F0F0EE;
      overflow: hidden;
      }
      td {
      font-size:12px;
      padding: 3px;
      }
     
    </style>
    <script type="text/javascript" src="../../../js/jquery.js"></script>
	<script type="text/javascript">
		var KE = parent.KE;
		location.href.match(/\?id=([\w-]+)/i);
		var id = RegExp.$1;
		var temp = "";
		KE.event.ready(function() {
			var componentName = KE.$('componentName', document);
			var componentTitle = KE.$('componentTitle', document);
			var componentType = KE.$('componentType', document);
			var fontSize = KE.$('fontSize', document);
			var componentSize = KE.$('componentSize',document);
			var g = KE.g[id];  
			var startNode =g.keRange.startNode;
			if(startNode.name!=undefined){
				if(startNode.getAttribute("title")!=null)componentTitle.value=startNode.getAttribute("title");
				if(startNode.getAttribute("datafld")!=null) componentType.value=startNode.getAttribute("datafld");
				if(startNode.getAttribute("name")!=null) componentName.value=startNode.getAttribute("name");
				if(startNode.getAttribute("style")!=null){
					fontSize.value=startNode.style.fontSize.substring(0,startNode.style.fontSize.indexOf("p"));
					componentSize.value=startNode.style.width.substring(0,startNode.style.width.indexOf("p"));
				}
			}
		}, window, document);
	</script>
  </head>
  <body>
     <table border="0" cellpadding="0" cellspacing="0">
	     <tr >
	      		<td align="right">宏控件名称：</td>
	      		<td><input  type="text" name="componentName" id="componentName" value="" maxlength="20"/></td>
	      		<td>字段名由英文母开始,数字和下划线组成.</td>
	      </tr>
	      <tr >
	      		<td align="right">宏控件标题：</td>
	      		<td><input  type="text" name="componentTitle" id="componentTitle" value="" maxlength="50"/></td>
	      		<td>非空且不能包含英文的"()[]"</td>
	      </tr>
	     <tr>
	     	<td align="right">宏控件类型：</td>
	     	<td>
	   			<select id="componentType" name="componentType">
	   				<optgroup label="---单行输入框---">
	   					<option value="SYS_DATE">当前日期,形如 2010-01-01</option>
		   				<option value="SYS_DATE_CN">当前日期,形如 2010年1月1日</option>
		   				<option value="SYS_DATE_CN_SHORT3">当前日期,形如 2010年</option>
		   				<option value="SYS_DATE_CN_SHORT4">当前年份,形如 2010</option>
		   				<option value="SYS_DATE_CN_SHORT1">当前日期,形如 2010年1月</option>
		   				<option value="SYS_DATE_CN_SHORT2">当前日期,形如 1月1日</option>
		   				<option value="SYS_TIME">当前时间</option>
		   				<option value="SYS_DATETIME">当前日期+时间</option>
		   				<option value="SYS_WEEK">当前星期中的第几天,形如 星期一</option>
		   				<option value="SYS_USERNAME">当前用户的姓名</option>
		   				<option value="SYS_DEPTNAME">当前用户部门名称</option>
		   				<option value="SYS_DEPTNAME_SHORT">当前用户部门简称</option>
		   				<option value="SYS_USERROLE">当前用户角色</option>
		   				<option value="SYS_USERNAME_DATE">当前用户的姓名+日期</option>
		   				<option value="SYS_USERNAME_DATETIME">当前用户的姓名+日期+时间</option>
		   				<option value="SYS_FORMNAME">表单名称</option>
		   				<option value="SYS_MANAGER1">部门主管(本部门)</option>
		   				<option value="SYS_MANAGER2">部门主管(上级部门)</option>
		   				<option value="SYS_MANAGER3">部门主管(一级部门)</option>
	   				</optgroup>
	   				<optgroup label="---下拉菜单---" >
	   					<option value="SYS_LIST_ROLE">角色列表</option>
		   				<option value="SYS_LIST_MANAGER1">部门主管(本部门)</option>
		   				<option value="SYS_LIST_MANAGER2">部门主管(上级部门)</option>
		   				<option value="SYS_LIST_MANAGER3">部门主管(一级部门)</option>
	   				</optgroup>
	   			</select>
	   		</td>
	     </tr>
	     <tr>
	     	<td align="right">字体大小：</td>
	   		<td><input  type="text" name="fontSize" id="fontSize" value="" />&nbsp;&nbsp;px</td>
	     </tr>
	     <tr>
	     	<td align="right">控件大小：</td>
	   		<td><input  type="text" name="componentSize" id="componentSize" value="" />&nbsp;&nbsp;px</td>
	     </tr>
    </table>
  </body>
</html>
